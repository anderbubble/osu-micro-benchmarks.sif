Bootstrap: docker
From: rockylinux:9
Stage: build

%post
dnf -y install mpich-devel gcc-c++
curl -LO https://mvapich.cse.ohio-state.edu/download/mvapich/osu-micro-benchmarks-7.5-1.tar.gz
tar -xf osu-micro-benchmarks-7.5-1.tar.gz
(
    cd osu-micro-benchmarks-7.5-1
    ./configure CC=/usr/lib64/mpich/bin/mpicc CXX=/usr/lib64/mpich/bin/mpicc
    make
    make install
)

Bootstrap: docker
From: rockylinux:9
Stage: final

%files from build
/usr/local/libexec/osu-micro-benchmarks

%post
dnf install -y mpich
dnf clean all

%labels
app osu-micro-benchmarks
mpi mpich
